{% extends 'base.html' %}
{% block content %}
<div class="card shadow-sm mb-4">
  <div class="card-body d-flex flex-column flex-lg-row align-items-lg-center gap-3">
    <div class="d-flex align-items-center gap-3">
      <img src="{{ modulo.logo_url }}" alt="{{ modulo.label }}" class="rounded shadow-sm" style="height:60px;">
      <div>
        <h4 class="mb-1">{{ cliente.nombre_razon_social }}</h4>
        <div class="text-muted small">{{ modulo.full_name }} · {{ modulo.label }}</div>
        <div class="text-muted small">Submódulo: <strong>{{ subtipo }}</strong></div>
      </div>
    </div>
    <div class="ms-lg-auto d-flex flex-wrap gap-2">
      <a href="{{ url_for('clientes.modulo_subtipos', id_cliente=cliente.id_cliente, inst=modulo.key) }}" class="btn btn-outline-secondary btn-sm">
        <i class="bi bi-arrow-left"></i> Volver a subtipos
      </a>
      <a href="{{ create_project_url }}" class="btn btn-primary btn-sm">
        <i class="bi bi-plus-circle"></i> Crear proyecto
      </a>
    </div>
  </div>
</div>

{% if no_anos %}
  <div class="alert alert-light border text-muted">
    <div class="d-flex align-items-center gap-2">
      <i class="bi bi-info-circle fs-4"></i>
      <div>
        <strong>No hay proyectos registrados en {{ subtipo }} para este cliente.</strong>
        <div>Creá un proyecto para iniciar el historial de años.</div>
      </div>
    </div>
    <div class="mt-3">
      <a href="{{ create_project_url }}" class="btn btn-primary">
        <i class="bi bi-plus-lg"></i> Crear proyecto
      </a>
    </div>
  </div>
{% else %}
  <div class="row g-3">
    {% for ano in anos %}
    <div class="col-md-4 col-lg-3">
      <a href="{{ url_for('proyectos.board', id_cliente=cliente.id_cliente, ano=ano, inst=modulo.key, tipo=subtipo) }}" class="text-decoration-none">
        <div class="card h-100 year-card shadow-sm border-0">
          <div class="card-body text-center py-4">
            <div class="rounded-circle bg-primary-subtle text-primary d-inline-flex align-items-center justify-content-center mb-3" style="width:64px;height:64px;">
              <i class="bi bi-calendar-check fs-3"></i>
            </div>
            <h5 class="fw-semibold mb-1">Año {{ ano }}</h5>
            <p class="text-muted small mb-0">Ver proyectos de {{ subtipo }}</p>
          </div>
        </div>
      </a>
    </div>
    {% endfor %}
  </div>
{% endif %}

<style>
.year-card {
  transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
}
.year-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 10px 24px rgba(0,0,0,0.1);
}
</style>
{% endblock %}
